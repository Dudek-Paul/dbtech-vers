package de.htwberlin.dbtech.aufgaben.ue03;

import de.htwberlin.dbtech.exceptions.DataException;
import org.slf4j.Logger;
import org.slf4j.LoggerFactory;

import java.sql.PreparedStatement;
import java.sql.ResultSet;
import java.sql.SQLException;

public class VertragGateway {
    private static final Logger L = LoggerFactory.getLogger(VertragGateway.class);

    public Vertrag find(Integer id) {
        String sql = "select ID from Vertrag where ID=?";
        L.info(sql);
        try (
                PreparedStatement ps = useConnection().prepareStatement(sql)) {
            ps.setInt(1, id);
            try (ResultSet rs = ps.executeQuery()) {
                return rs.next();
            }
        } catch (
                SQLException e) {
            L.error("", e);
            throw new DataException(e);
        }
    }
